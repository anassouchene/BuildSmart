import{q as v,r as o,j as e,L as b}from"./index-Dtz4I_N3.js";import{a as d,B as p}from"./config-CrOwxi8G.js";import{S as i}from"./sweetalert2.all-rCSAqTKa.js";import{T as A,a as y,b as w,c as m,d as s,e as B}from"./TableRow-QNjXHaqo.js";import{P as E}from"./Paper-qxPhMhKx.js";import{B as C}from"./Button-DOCNOP_s.js";import"./ButtonBase-B3uAvr5I.js";const M=()=>{const{id:n}=v(),[u,h]=o.useState([]),[x,l]=o.useState(!0),[c,f]=o.useState(null);if(o.useEffect(()=>{(async()=>{try{const r=await d.get(`${p}Etages/${n}/appartements`);console.log(r.data.$values),h(r.data.$values||[]),l(!1)}catch(r){f(r),l(!1)}})()},[n]),x)return e.jsx("div",{children:"Loading..."});if(c)return e.jsxs("div",{children:["Error: ",c.message]});const j=t=>({position:"absolute",width:"50%",height:"50%",...[{top:"0",left:"0"},{top:"0",left:"50%"},{top:"50%",left:"50%"},{top:"50%",left:"0"}][t]}),g=async t=>{try{if(i.showLoading(),(await i.fire({title:"Confirmation",text:"Êtes-vous sûr de vouloir libérer cet appartement ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, libérer",cancelButtonText:"Annuler"})).isConfirmed){const a={idUser:t.gestAppartementId,appartementId:t.id};(await d.post(`${p}RetraitAppartement`,a)).status===200?i.fire({title:"Succès",text:"Appartement libéré avec succès !",icon:"success",showConfirmButton:!1,timer:2e3}):i.fire({title:"Erreur",text:"Une erreur s'est produite lors de la libération de l'appartement.",icon:"error"})}}catch(r){console.error("Erreur lors de la libération de l'appartement :",r),i.fire({title:"Erreur",text:"Une erreur s'est produite lors de la libération de l'appartement.",icon:"error"})}};return e.jsxs("div",{children:[e.jsxs("h1",{children:["Étage ",n]}),e.jsx("div",{className:"appartements",children:u.map(t=>e.jsxs("div",{className:"appartement",children:[e.jsxs("h2",{children:["Appartement ",t.id]}),e.jsxs("div",{className:"appartement-image-container",style:{position:"relative",width:"100%",height:"auto"},children:[e.jsx("img",{src:"appartement.png",alt:`Appartement ${t.id}`,className:"appartement-image",style:{width:"100%",height:"auto"}}),t.chambres.$values.map((r,a)=>e.jsx(b,{to:`/appartement/${t.id}/chambre/${r.id}`,className:`appartement-part part${a+1}`,style:j(a)},r.id))]}),e.jsx(A,{component:E,children:e.jsxs(y,{children:[e.jsx(w,{children:e.jsxs(m,{children:[e.jsx(s,{children:"ID du périphérique"}),e.jsx(s,{children:"Adresse MAC"}),e.jsx(s,{children:"État"}),e.jsx(s,{children:"Etat d'appartement"}),t.gestAppartementId&&e.jsx(s,{children:"Actions"})]})}),e.jsx(B,{children:e.jsxs(m,{children:[e.jsx(s,{children:t.device.id}),e.jsx(s,{children:t.device.adresseMac}),e.jsxs(s,{style:{color:t.device.adresseMac==null?"red":"Green"},children:["  ",t.device.adresseMac==null?"Down":"Actif"]}),e.jsx(s,{style:{color:t.gestAppartementId?"gray":"green"},children:t.gestAppartementId?"Réservé":"Libre"}),t.gestAppartementId&&e.jsx(s,{children:e.jsx(C,{variant:"contained",color:"secondary",onClick:()=>g(t),children:"Libérer"})})]})})]})})]},t.id))})]})};export{M as default};
